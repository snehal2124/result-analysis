<div class="mt-4 mx-2 d-flex flex-row justify-content-center">
  <div class="d-flex flex-column w-100" *ngIf="results.length">
    <div class="d-flex flex-row justify-content-between w-100" [formGroup]="filterForm">
      <div class="form-group mt-2">
        <label for="batchtid">Specializations</label>
        <select class="form-select mt-2" placeholder="Select Specialization" formControlName="specialization">
          <option *ngFor="let specialization of specializations" [value]="specialization.id">{{specialization.name}}
          </option>
        </select>
      </div>
      <div class="form-group mt-2">
        <label for="batchtid">Batch</label>
        <select class="form-select mt-2" placeholder="Select Batch" formControlName="batch">
          <option value="all">All</option>
          <option *ngFor="let batch of batches" [value]="batch.id">{{batch.name}}
          </option>
        </select>
      </div>
      <div class="form-group mt-2">
        <label for="semesterid">Semester</label>
        <select class="form-select mt-2" placeholder="Select Semester" formControlName="semester">
          <option value="all">All</option>
          <option *ngFor="let semester of semesters" [value]="semester.id">{{semester.name}}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="subject">Subject</label>
        <select class="form-select mt-2" placeholder="Select Subject" formControlName="subject">
          <option value="all">All</option>
          <option *ngFor="let subject of subjects" [value]="subject.id">{{subject.name}}
          </option>
        </select>
      </div>
    </div>
    <div class="w-50 d-flex flex-row justify-content-between mt-4">
      <div>
        <h6>Average Marks by Batch</h6>
        <canvas class="bar-chart" baseChart [data]="batchChartData" [options]="barChartOptions"
          [plugins]="barChartPlugins" [legend]="barChartLegend" [type]="'bar'">
        </canvas>
      </div>
      <div>
        <h6>Average Marks by Subjects</h6>
        <canvas class="bar-chart" baseChart [data]="subjectChartData" [options]="barChartOptions"
          [plugins]="barChartPlugins" [legend]="barChartLegend" [type]="'bar'">
        </canvas>
      </div>
    </div>

    <table class="table mt-4">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Specialization</th>
          <th scope="col">Batch</th>
          <th scope="col">Semester</th>
          <th scope="col">Subject</th>
          <th scope="col">Student</th>
          <th scope="col">Marks obtained</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let result of results | slice: (page-1) * pageSize : page * pageSize">
          <tr>
            <th scope="row">{{result.id}}</th>
            <td>{{result.specialization_id?.name}}</td>
            <td>{{result.batch_id?.name}}</td>
            <td>{{result.semester_id?.name}}</td>
            <td>{{result.subject_id?.name}}</td>
            <td>{{result.student_id?.first_name + ' ' + result.student_id?.last_name}}</td>
            <td>{{result.marks_obtained}}</td>
          </tr>
        </ng-container>
      </tbody>
    </table>
    <ngb-pagination class="d-flex flex-row justify-content-center" [(page)]="page" [pageSize]="pageSize"
      [collectionSize]="results.length"></ngb-pagination>

  </div>
  <div *ngIf="!results.length" #no_results_found>
    <h5 class="mt-4 pt-4">
      No Results found.
    </h5>
  </div>
</div>
