<div class="container p-2 my-4">
  <div class="d-flex flex-row justify-content-between">
    <h3>Subjects</h3>
    <button type="button" class="btn btn-outline-dark btn-sm" (click)="openAddSubjectModal(subjectModal)">Add
      Subject</button>
  </div>
  <div class="mt-4 d-flex flex-row justify-content-center">
    <div class="d-flex flex-column align-items-center w-100" *ngIf="subjects.length">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">Semester id</th>
            <th scope="col">Total marks</th>
            <th scope="col">Code</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let Subject of subjects  | slice: (page-1) * pageSize : page * pageSize">
            <tr>
              <th scope="row">{{Subject.index}}</th>
              <td>{{Subject.name}}</td>
              <td>{{Subject.semester_id}}</td>
              <td>{{Subject.total_marks}}</td>
              <td>{{Subject.code}}</td>
              <td class="d-flex flex-row">
                <i class="bi bi-pencil-fill" (click)="openEditSubjectModal(Subject, subjectModal)"></i>
                <i class="bi bi-trash3-fill mx-4" (click)="openDeleteSubjectModal(Subject, deleteSubjectModal)"></i>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
      <ngb-pagination [(page)]="page" [pageSize]="pageSize" [collectionSize]="subjects.length"></ngb-pagination>
    </div>
    <ng-container *ngIf="!subjects.length" #no_subjects_found>
      <h5 class="mt-4 pt-4">
        No Subjects found.
      </h5>
    </ng-container>
  </div>
</div>

<!-- Add subject Modal -->
<ng-template #subjectModal let-subjectmodal>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="subjectModalLabel">{{actionType === 'add' ? 'Add' : 'Edit'}} Subject</h5>
      <div class="fs-5" aria-label="Close" (click)="subjectmodal.dismiss()">
        <i class="bi bi-x-circle"></i>
      </div>
    </div>
    <div class="modal-body">
      <form [formGroup]="subjectForm">
        <div class="form-group">
          <label for="subjectName">Name</label>
          <input id="subjectName" type="text" class="form-control" placeholder="Name" aria-label="Name"
            aria-describedby="basic-addon1" formControlName="name">
        </div>
        <div class="d-flex flex-row justify-content-between">

          <div class="form-group mt-2">
            <label for="totalmarks">Total marks</label>
            <input type="text" class="form-control" id="totalmarks" placeholder="Total Marks"
              formControlName="total_marks">
          </div>
          <div class="form-group mt-2">
            <label for="subjectCode">Code</label>
            <input type="text" class="form-control" id="subjectCode" placeholder="Code" formControlName="code">
          </div>
        </div>
        <div class="form-group mt-2">
          <label for="semester">Semester</label>
          <select class="form-select mt-2" placeholder="Select Semester" formControlName="semester_id">
            <option *ngFor="let semester of semesters" [value]="semester.id">{{semester.name}}
            </option>
          </select>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn-outline-secondary btn-sm" (click)="subjectmodal.dismiss()">Cancel</button>
      <button type="button" class="btn btn-outline-dark btn-sm"
        (click)="actionType  === 'add' ? createSubject() : updateSubject()">Save</button>
    </div>
  </div>
</ng-template>

<!-- Delete Subject Confirmation Modal -->
<ng-template #deleteSubjectModal let-deletesubjectmodal>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="deleteSubjectModalLabel">Confirmation</h5>
      <div class="fs-5" aria-label="Close" (click)="deletesubjectmodal.dismiss()">
        <i class="bi bi-x-circle"></i>
      </div>
    </div>
    <div class="modal-body">
      <form>
        Are you sure, you want to delete this subject?
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-secondary btn-sm" (click)="deletesubjectmodal.dismiss()">No</button>
      <button type="button" class="btn btn-outline-dark btn-sm" (click)="deletesubjectmodal.close()">Yes</button>
    </div>
  </div>
</ng-template>
